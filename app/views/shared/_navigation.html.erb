<%
  # navigation is not fixed unless explicitly set
  fixed ||= false
%>

<nav id="main_navigation" class="<%= fixed ? "fixed " : "" %>primary_color">
  <div class="container-fluid">
    <div class="nav-wrapper row">
      <div class="col s12">
        <%= link_to root_path, class: 'brand-logo' do %>
          <%= image_tag "logo_bold_100p.png" %> Upshift
        <% end %>
        <a id="toggle_mobile_navigation" href="#" data-activates="mobile_navigation" class="button-collapse">
          <%= material_icon.menu %>
        </a>

        <ul class="right hide-on-med-and-down">

          <% if @current_user %>

            <li>
              <%= link_to profile_path(@current_user), class: 'tooltipped', data: {position: 'bottom', delay: '50', tooltip: 'My Profile'} do %>
                <%= material_icon.account_circle %>
              <% end %>
            </li>

            <li>
              <%= link_to private_conversations_home_path, class: 'tooltipped', data: {position: 'bottom', delay: '50', tooltip: 'Conversations'} do %>
                <%= material_icon.chat_bubble %>
                <% if @current_user.unread_private_conversations.size > 0 %>
                  <span class="white red-text z-depth-1 badge">
                    <%= @current_user.unread_private_conversations.size %>
                  </span>
                <% end %>
              <% end %>
            </li>

            <li>
              <%= link_to logout_path, class: 'tooltipped', data: {position: 'bottom', delay: '50', tooltip: 'Logout'} do %>
                <%= material_icon.power_settings_new %>
              <% end %>
            </li>

          <% else %>

            <li>
              <%= link_to login_path do %>
                <i class="material-icons right">power_settings_new</i>
                Login
              <% end %>
            </li>

          <% end %>

        </ul>
        <ul id="mobile_navigation" class="side-nav" >

          <% if @current_user %>

            <%= render partial: "shared/side_navigation" %>

            <li><div class="divider"></div></li>

            <li>
              <%= link_to profile_path(@current_user) do %>
                <%= material_icon.account_circle %>
                <span class="content">
                  My Profile
                </span>
              <% end %>
            </li>

            <li>
              <%= link_to private_conversations_home_path do %>

                <%# unread conversations indicator %>
                <% if @current_user.unread_private_conversations.size > 0 %>
                  <span class="red white-text badge">
                    <%= @current_user.unread_private_conversations.size %>
                  </span>
                <% end %>

                <%= material_icon.chat_bubble %>
                <span class="content">
                  Conversations
                </span>
              <% end %>
            </li>

            <li>
              <%= link_to logout_path do %>
                <%= material_icon.power_settings_new %>
                <span class="content">
                  Logout
                </span>
              <% end %>
            </li>

          <% else %>

            <%= nav_link "Home",  root_path,  {:icon => "home"} %>
            <%= nav_link "Login", login_path, {:icon => "power_settings_new"} %>

          <% end %>
        </ul>
      </div>
    </div>
  </div>
</nav>
